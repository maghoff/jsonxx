#!/bin/env python
# -*- coding: utf-8 -*-

def build(bld):
    sources = [
        'compact_writer.cpp',
        'deserializer.cpp',
        'indenting_writer.cpp',
        'null_object_listener.cpp',
        'object_filter.cpp',
        'object_listener.cpp',
        'parser.cpp',
        'util.cpp',
        'validating_filter.cpp',
        'writer_base.cpp',
        '../import/libjson/json.c',
    ]

    obj = bld.new_task_gen(
        features='cc cxx cshlib',
        source=sources,
        target='jsonxx',
        defines=['JSONXX_LINK_VARIANT=2'],
    )

    # This is a bit of a peculiar waf-thing. The build
    # task is automatically configured to run in the
    # default-configuration, but it needs this line in
    # order to build in the debug-configuration:
    obj.clone('debug')
